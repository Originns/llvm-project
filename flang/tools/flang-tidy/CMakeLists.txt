link_directories(${LLVM_LIBRARY_DIR})

set(LLVM_LINK_COMPONENTS
  ${LLVM_TARGETS_TO_BUILD}
  FrontendOpenACC
  FrontendOpenMP
  Support
  Option
  TargetParser
  )

add_flang_tool(flang-tidy
  bugprone/ArithmeticGotoCheck.cpp
  bugprone/ArithmeticIfStmtCheck.cpp
  bugprone/BugproneTidyModule.cpp
  bugprone/ImplicitDeclCheck.cpp
  bugprone/ImpliedSaveCheck.cpp
  bugprone/MissingActionCheck.cpp
  bugprone/MissingDefaultCheck.cpp
  bugprone/PrecisionLossCheck.cpp
  bugprone/SubprogramTrampolineCheck.cpp
  bugprone/UndeclaredProcCheck.cpp
  bugprone/UninitializedVarCheck.cpp
  bugprone/UnusedIntentCheck.cpp
  FlangTidy.cpp
  FlangTidyModule.cpp
  misc/MiscTidyModule.cpp
  misc/PureProcedureCheck.cpp
  misc/UnusedUseCheck.cpp
  modernize/AvoidAssignStmt.cpp
  modernize/AvoidBackspaceStmt.cpp
  modernize/AvoidCommonBlocks.cpp
  modernize/AvoidDataConstructs.cpp
  modernize/AvoidPauseStmt.cpp
  modernize/ModernizeTidyModule.cpp
  tool/FlangTidyMain.cpp
  tool/FlangTidyToolMain.cpp
)

llvm_update_compile_flags(flang-tidy)

target_link_libraries(flang-tidy
  PRIVATE
  FortranCommon
  FortranEvaluate
  FortranParser
  FortranSemantics
  LLVMSupport
  flangFrontend
  flangFrontendTool
  )
